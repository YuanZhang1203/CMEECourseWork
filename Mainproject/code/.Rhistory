rm(list = ls())
graphics.off()
#--------- Load some packages --------#
library("dplyr")
library("ggplot2")
library("gridExtra")
library("ggforce")
library("pdftools")
library("ggpubr")
#--------- Load dataset and check levels --------#
data <- read.csv("../data/simple.csv")
unique((data$species))
b <- subset(data, data$Variable == "Fecundity")
b <- gdata::drop.levels(b)
unique((b$species))
#-----------------------------------------------------------------------------------------------------------------#
#------------------------------------------------"Coleoptera"-----------------------------------------------------------------#
#### 1.  "Anthonomus grandis" ####
d1 <- subset(data, data$species == "Anthonomus grandis")
d1 <- gdata::drop.levels(d1)
# check Variables
unique(d1$Variable)
# "Adult Mortality Rate (z)" "Development Time (a)"     "Fecundity"
#### a
a1 <- subset(d1, d1$Variable == "Development Time (a)")
a1 <- subset(a1, a1$stage == "Immature Stages")
a1 <- gdata::drop.levels(a1)
p_a1 <- ggplot(a1, aes(x=temp, y = traitvalue))  + geom_point() + geom_smooth()+
labs(title = "TPC of Development Time (a)",
x = "Temperature (\u00B0C) ",
y = "Development Time (days)") +
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size=8),
axis.title.y=element_text(size=8))
ggsave("../results/TPC_a1.pdf", plot = p_a1)
####  z
z1 <- subset(d1, d1$Variable == "Adult Mortality Rate (z)")
z1 <- subset(z1, z1$originaltraitname == "Longevity")
z1 <- gdata::drop.levels(z1)
z1$stdvalue <- 1/z1$traitvalue
p_z1 <-  ggplot(z1, aes(x=temp, y = stdvalue))  + geom_point() + geom_smooth()+
labs(title = "TPC of Adult Mortality Rate (z)",
x = "Temperature (\u00B0C) ",
y = "Adult Mortality Rate (1/day)") +
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size=8),
axis.title.y=element_text(size=8))
ggsave("../results/TPC_z1.pdf", plot = p_z1)
#### zj
zj1 <- subset(d1, d1$Variable == "Adult Mortality Rate (z)")
zj1 <- subset(zj1, zj1$time != "NA")
zj10 <- gdata::drop.levels(zj10)
# no time information of juvenile, so delete this trait
#### Fecundity b & k
b1 <- subset(b, b$species == "Anthonomus grandis")
b1 <- gdata::drop.levels(b1)
b1$stdvalue <- b1$traitvalue
b1$logvalue <- log(b1$stdvalue)
# check units
unique(b1$unit) # "Eggs/female/day"
## plot b ~ time
bpk1 <- c()
k1 <- c()
temp1 <- unique(b1$temp)  # get temperature ranges: 15 20 25 30 35
for (i in 1: length(temp1)) {
df <- b1[which(b1$temp == temp1[i]),]
bpk1[i] = max(df$traitvalue)
df$stdvalue <- df$traitvalue
pbt <- ggplot(df, aes(x = time, y = stdvalue))+ geom_point() + geom_smooth()+
labs(title = paste("Anthonomus grandis",temp1[i],"(\u00B0C)",sep = "" ),
x = "Temperature (\u00B0C)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave(paste("../Results/bt_1.Anthonomus grandis:", temp1[i], ":.png",sep = ""), device = png())
lm <- lm(logvalue ~ time, data = df)
k1[i] <- coef(lm)[2]
}
bpk1 <- data.frame(bpk1, temp1, k1)
## plot bpk ~ temperature
p_bpk1 <- ggplot(bpk1, aes(x = temp1, y = bpk1))+ geom_point() + geom_smooth()+
labs(title = "TPC of Peak Fecundity Rate (b)",
x = "Temperature (\u00B0C)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave("../results/TPC_bpk1.pdf", plot = p_bpk1)
## plot k ~temperature
p_k1<- ggplot(bpk1, aes(x = temp1, y = k1))+ geom_point() + geom_smooth()+
labs(title = "TPC of Fecundity Loss Rate (k)",
x = "Time (days)",
y = "Fecundity Loss Rate")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave("../results/TPC_k1.pdf", plot = p_k1)
#### put together
p1 <- plot_grid(
p_a1,p_z1,p_bpk1,p_k1,labels = c("a","z","b","k"),
ncol=2,nrow=2)
p1 <- annotate_figure(p1, top = text_grob("1. Anthonomus grandis", color = "red", face = "bold", size = 14))
ggsave("../results/TPC_1.pdf", plot = p1)
d2 <- subset(data, data$species == "Sitona discoideus")
d2 <- gdata::drop.levels(d2)
View(d2)
d2$location
d2 <- subset(data, data$species == "Stethorus punctillum")
d2 <- gdata::drop.levels(d2)
View(d2)
unique(d2$Variable)
a2 <- subset(d2, d2$Variable == "Development Time (a)")
a2 <- subset(a2, a2$originaltraitname == "Development Rate")
View(a2)
a2$stdvalue <- 1/a2$traitvalue
a2 <- subset(a2, a2$traitvalue != "0")
View(a2)
a2$location
a2 <- gdata::drop.levels(a2)
stage2 <- unique(a2$stage)
stage
stage2
a2$stdvalue <- 1/a2$traitvalue
a2 <- gdata::drop.levels(a2)
stage2 <- unique(a2$stage) #get stage ranges: "Egg"  "1st instar" "2nd instar" "3rd instar" "4th instar" "Pupae"
for (i in 1: length(stage2)) {
df <- a2[which(a2$stage == stage2[i]),]
p_a2 <- ggplot(df, aes(x = temp, y = stdvalue))+ geom_point() + geom_smooth()+
labs(title = paste("Stethorus punctillum",stage2[i],sep = "" ),
x = "Temperature (\u00B0C)",
y = "Development Time (days)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave(paste("../Results/a_2.Anthonomus grandis:", stage2[i], ":.png",sep = ""), device = png())
}
for (i in 1: length(stage2)) {
df <- a2[which(a2$stage == stage2[i]),]
p_a2 <- ggplot(df, aes(x = temp, y = stdvalue))+ geom_point() + geom_smooth()+
labs(title = paste("Stethorus punctillum:",stage2[i],sep = "" ),
x = "Temperature (\u00B0C)",
y = "Development Time (days)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave(paste("../Results/a_2.Anthonomus grandis:", stage2[i], ":.png",sep = ""), device = png())
}
for (i in 1: length(stage2)) {
df <- a2[which(a2$stage == stage2[i]),]
a2$stdname  <- paste(stage2[i])}
View(a2)
p_a2 <- ggplot(a2, aes(x = temp, y = stdvalue)) + geom_point() + theme_bw() +
labs(title=expression(paste("2.Stethorus punctillum:TPC of Development Time (a)"),
x = "Temperature (\u00B0C)",
y = "Development Time (days)"))
p_a2 <- p_a2 + facet_wrap(~ stage, ncol = 2, scales = "free")+ geom_smooth()
p_a2
p_a2 <- ggplot(a2, aes(x = temp, y = stdvalue)) + geom_point() + theme_bw() +
labs(x = "Temperature (\u00B0C)",
y = "Development Time (days)")
p_a2 <- p_a2 + facet_wrap(~ stage, ncol = 2, scales = "free")+ geom_smooth()
p2 <- annotate_figure(p_a2, top = text_grob("1. Stethorus punctillum", color = "red", face = "bold", size = 14))
ggsave("../results/TPC_2.pdf", plot = p2)
p_a2 <- ggplot(a2, aes(x = temp, y = stdvalue)) + geom_point() + theme_bw() +
labs(x = "Temperature (\u00B0C)",
y = "Development Time (days)")
p_a2 <- p_a2 + facet_wrap(~ stage, ncol = 2, scales = "free")+ geom_smooth()
p2 <- annotate_figure(p_a2, top = text_grob("2. Stethorus punctillum", color = "red", face = "bold", size = 14))
ggsave("../results/TPC_2.pdf", plot = p2)
#### a
a2 <- subset(d2, d2$Variable == "Development Time (a)")
a2 <- subset(a2, a2$originaltraitname == "Development Rate")
a2 <- subset(a2, a2$traitvalue != "0")
a2$stdvalue <- 1/a2$traitvalue
a2 <- gdata::drop.levels(a2)
stage2 <- unique(a2$stage) #get stage ranges: "Egg"  "1st instar" "2nd instar" "3rd instar" "4th instar" "Pupae"
p_a2 <- ggplot(a2, aes(x = temp, y = stdvalue)) + geom_point() + theme_bw() +
labs(title = "TPC of Development Time (a)",
x = "Temperature (\u00B0C)",
y = "Development Time (days)")
p_a2 <- p_a2 + facet_wrap(~ stage, ncol = 2, scales = "free")+ geom_smooth()
p2 <- annotate_figure(p_a2, top = text_grob("2. Stethorus punctillum", color = "red", face = "bold", size = 14))
ggsave("../results/TPC_2.pdf", plot = p2)
#!usr/bin/env R
###########################################################################################################
# Title: 3. Put all TPCs together in R
# MSc CMEE
# Aug 2020
# Author: YUAN ZHANG
############################################################################################################
rm(list = ls())
graphics.off()
#--------- Load some packages --------#
library("dplyr")
library("ggplot2")
library("gridExtra")
library("ggforce")
library("pdftools")
library("ggpubr")
#--------- Load dataset and check levels --------#
data <- read.csv("../data/simple.csv")
unique((data$species))
b <- subset(data, data$Variable == "Fecundity")
b <- gdata::drop.levels(b)
unique((b$species))
#-----------------------------------------------------------------------------------------------------------------#
#------------------------------------------------"Coleoptera"-----------------------------------------------------------------#
#### 1.  "Anthonomus grandis" ####
d1 <- subset(data, data$species == "Anthonomus grandis")
d1 <- gdata::drop.levels(d1)
# check Variables
unique(d1$Variable)
# "Adult Mortality Rate (z)" "Development Time (a)"     "Fecundity"
#### a
a1 <- subset(d1, d1$Variable == "Development Time (a)")
a1 <- subset(a1, a1$stage == "Immature Stages")
a1 <- gdata::drop.levels(a1)
p_a1 <- ggplot(a1, aes(x=temp, y = traitvalue))  + geom_point() + geom_smooth()+
labs(title = "TPC of Development Time (a)",
x = "Temperature (\u00B0C) ",
y = "Development Time (days)") +
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size=8),
axis.title.y=element_text(size=8))
ggsave("../results/TPC_a1.pdf", plot = p_a1)
####  z
z1 <- subset(d1, d1$Variable == "Adult Mortality Rate (z)")
z1 <- subset(z1, z1$originaltraitname == "Longevity")
z1 <- gdata::drop.levels(z1)
z1$stdvalue <- 1/z1$traitvalue
p_z1 <-  ggplot(z1, aes(x=temp, y = stdvalue))  + geom_point() + geom_smooth()+
labs(title = "TPC of Adult Mortality Rate (z)",
x = "Temperature (\u00B0C) ",
y = "Adult Mortality Rate (1/day)") +
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size=8),
axis.title.y=element_text(size=8))
ggsave("../results/TPC_z1.pdf", plot = p_z1)
#### zj
zj1 <- subset(d1, d1$Variable == "Adult Mortality Rate (z)")
zj1 <- subset(zj1, zj1$time != "NA")
zj10 <- gdata::drop.levels(zj10)
# no time information of juvenile, so delete this trait
#### Fecundity b & k
b1 <- subset(b, b$species == "Anthonomus grandis")
b1 <- gdata::drop.levels(b1)
b1$stdvalue <- b1$traitvalue
b1$logvalue <- log(b1$stdvalue)
# check units
unique(b1$unit) # "Eggs/female/day"
## plot b ~ time
bpk1 <- c()
k1 <- c()
temp1 <- unique(b1$temp)  # get temperature ranges: 15 20 25 30 35
for (i in 1: length(temp1)) {
df <- b1[which(b1$temp == temp1[i]),]
bpk1[i] = max(df$traitvalue)
df$stdvalue <- df$traitvalue
pbt <- ggplot(df, aes(x = time, y = stdvalue))+ geom_point() + geom_smooth()+
labs(title = paste("Anthonomus grandis",temp1[i],"(\u00B0C)",sep = "" ),
x = "Temperature (\u00B0C)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave(paste("../Results/bt_1.Anthonomus grandis:", temp1[i], ":.png",sep = ""), device = png())
lm <- lm(logvalue ~ time, data = df)
k1[i] <- coef(lm)[2]
}
bpk1 <- data.frame(bpk1, temp1, k1)
## plot bpk ~ temperature
p_bpk1 <- ggplot(bpk1, aes(x = temp1, y = bpk1))+ geom_point() + geom_smooth()+
labs(title = "TPC of Peak Fecundity Rate (b)",
x = "Temperature (\u00B0C)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave("../results/TPC_bpk1.pdf", plot = p_bpk1)
## plot k ~temperature
p_k1<- ggplot(bpk1, aes(x = temp1, y = k1))+ geom_point() + geom_smooth()+
labs(title = "TPC of Fecundity Loss Rate (k)",
x = "Time (days)",
y = "Fecundity Loss Rate")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave("../results/TPC_k1.pdf", plot = p_k1)
#### put together
p1 <- plot_grid(
p_a1,p_z1,p_bpk1,p_k1,labels = c("a","z","b","k"),
ncol=2,nrow=2)
p1 <- annotate_figure(p1, top = text_grob("1. Anthonomus grandis", color = "red", face = "bold", size = 14))
ggsave("../results/TPC_1.pdf", plot = p1)
#### 2.  "Stethorus punctillum" ####
d2 <- subset(data, data$species == "Stethorus punctillum")
d2 <- gdata::drop.levels(d2)
unique(d2$Variable) # "Adult Mortality Rate (z)" "Development Time (a)"
#### a
a2 <- subset(d2, d2$Variable == "Development Time (a)")
a2 <- subset(a2, a2$originaltraitname == "Development Rate")
a2 <- subset(a2, a2$traitvalue != "0")
a2$stdvalue <- 1/a2$traitvalue
a2 <- gdata::drop.levels(a2)
stage2 <- unique(a2$stage) #get stage ranges: "Egg"  "1st instar" "2nd instar" "3rd instar" "4th instar" "Pupae"
p_a2 <- ggplot(a2, aes(x = temp, y = stdvalue)) + geom_point() + theme_bw() +
labs(title = "TPC of Development Time (a)",
x = "Temperature (\u00B0C)",
y = "Development Time (days)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
p_a2 <- p_a2 + facet_wrap(~ stage, ncol = 2, scales = "free")+ geom_smooth()
p2 <- annotate_figure(p_a2, top = text_grob("2. Stethorus punctillum", color = "red", face = "bold", size = 14))
ggsave("../results/TPC_2.pdf", plot = p2)
#!usr/bin/env R
###########################################################################################################
# Title: 3. Put all TPCs together in R
# MSc CMEE
# Aug 2020
# Author: YUAN ZHANG
############################################################################################################
rm(list = ls())
graphics.off()
#--------- Load some packages --------#
library("dplyr")
library("ggplot2")
library("gridExtra")
library("ggforce")
library("pdftools")
library("ggpubr")
#--------- Load dataset and check levels --------#
data <- read.csv("../data/simple.csv")
unique((data$species))
b <- subset(data, data$Variable == "Fecundity")
b <- gdata::drop.levels(b)
unique((b$species))
#-----------------------------------------------------------------------------------------------------------------#
#------------------------------------------------"Coleoptera"-----------------------------------------------------------------#
#### 1.  "Anthonomus grandis" ####
d1 <- subset(data, data$species == "Anthonomus grandis")
d1 <- gdata::drop.levels(d1)
# check Variables
unique(d1$Variable)
# "Adult Mortality Rate (z)" "Development Time (a)"     "Fecundity"
#### a
a1 <- subset(d1, d1$Variable == "Development Time (a)")
a1 <- subset(a1, a1$stage == "Immature Stages")
a1 <- gdata::drop.levels(a1)
p_a1 <- ggplot(a1, aes(x=temp, y = traitvalue))  + geom_point() + geom_smooth()+
labs(title = "TPC of Development Time (a)",
x = "Temperature (\u00B0C) ",
y = "Development Time (days)") +
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size=8),
axis.title.y=element_text(size=8))
ggsave("../results/TPC_a1.pdf", plot = p_a1)
####  z
z1 <- subset(d1, d1$Variable == "Adult Mortality Rate (z)")
z1 <- subset(z1, z1$originaltraitname == "Longevity")
z1 <- gdata::drop.levels(z1)
z1$stdvalue <- 1/z1$traitvalue
p_z1 <-  ggplot(z1, aes(x=temp, y = stdvalue))  + geom_point() + geom_smooth()+
labs(title = "TPC of Adult Mortality Rate (z)",
x = "Temperature (\u00B0C) ",
y = "Adult Mortality Rate (1/day)") +
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size=8),
axis.title.y=element_text(size=8))
ggsave("../results/TPC_z1.pdf", plot = p_z1)
#### zj
zj1 <- subset(d1, d1$Variable == "Adult Mortality Rate (z)")
zj1 <- subset(zj1, zj1$time != "NA")
zj10 <- gdata::drop.levels(zj10)
# no time information of juvenile, so delete this trait
#### Fecundity b & k
b1 <- subset(b, b$species == "Anthonomus grandis")
b1 <- gdata::drop.levels(b1)
b1$stdvalue <- b1$traitvalue
b1$logvalue <- log(b1$stdvalue)
# check units
unique(b1$unit) # "Eggs/female/day"
## plot b ~ time
bpk1 <- c()
k1 <- c()
temp1 <- unique(b1$temp)  # get temperature ranges: 15 20 25 30 35
for (i in 1: length(temp1)) {
df <- b1[which(b1$temp == temp1[i]),]
bpk1[i] = max(df$traitvalue)
df$stdvalue <- df$traitvalue
pbt <- ggplot(df, aes(x = time, y = stdvalue))+ geom_point() + geom_smooth()+
labs(title = paste("Anthonomus grandis",temp1[i],"(\u00B0C)",sep = "" ),
x = "Temperature (\u00B0C)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave(paste("../Results/bt_1.Anthonomus grandis:", temp1[i], ":.png",sep = ""), device = png())
lm <- lm(logvalue ~ time, data = df)
k1[i] <- coef(lm)[2]
}
bpk1 <- data.frame(bpk1, temp1, k1)
## plot bpk ~ temperature
p_bpk1 <- ggplot(bpk1, aes(x = temp1, y = bpk1))+ geom_point() + geom_smooth()+
labs(title = "TPC of Peak Fecundity Rate (b)",
x = "Temperature (\u00B0C)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave("../results/TPC_bpk1.pdf", plot = p_bpk1)
## plot k ~temperature
p_k1<- ggplot(bpk1, aes(x = temp1, y = k1))+ geom_point() + geom_smooth()+
labs(title = "TPC of Fecundity Loss Rate (k)",
x = "Time (days)",
y = "Fecundity Loss Rate")+
theme(plot.title = element_text(hjust = 0.5,size = 8, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 8),
axis.title.y=element_text(size= 8))
ggsave("../results/TPC_k1.pdf", plot = p_k1)
#### put together
p1 <- plot_grid(
p_a1,p_z1,p_bpk1,p_k1,labels = c("a","z","b","k"),
ncol=2,nrow=2)
p1 <- annotate_figure(p1, top = text_grob("1. Anthonomus grandis", color = "red", face = "bold", size = 14))
ggsave("../results/TPC_1.pdf", plot = p1)
#### 2.  "Stethorus punctillum" ####
d2 <- subset(data, data$species == "Stethorus punctillum")
d2 <- gdata::drop.levels(d2)
unique(d2$Variable) # "Adult Mortality Rate (z)" "Development Time (a)"
#### a
a2 <- subset(d2, d2$Variable == "Development Time (a)")
a2 <- subset(a2, a2$originaltraitname == "Development Rate")
a2 <- subset(a2, a2$traitvalue != "0")
a2$stdvalue <- 1/a2$traitvalue
a2 <- gdata::drop.levels(a2)
stage2 <- unique(a2$stage) #get stage ranges: "Egg"  "1st instar" "2nd instar" "3rd instar" "4th instar" "Pupae"
p_a2 <- ggplot(a2, aes(x = temp, y = stdvalue)) + geom_point() + theme_bw() +
labs(title = "TPC of Development Time (a)",
x = "Temperature (\u00B0C)",
y = "Development Time (days)")+
theme(plot.title = element_text(hjust = 0.5,size = 10, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 10),
axis.title.y=element_text(size= 10))
p_a2 <- p_a2 + facet_wrap(~ stage, ncol = 2, scales = "free")+ geom_smooth()
p2 <- annotate_figure(p_a2, top = text_grob("2. Stethorus punctillum", color = "red", face = "bold", size = 14))
ggsave("../results/TPC_2.pdf", plot = p2)
p_bt <- ggplot(a2, aes(x = time, y = stdvalue)) + geom_point() + theme_bw() +
labs(title = "Fecundity change with time: 1.Anthonomus grandis",
x = "Time (days)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 10, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 10),
axis.title.y=element_text(size= 10))
p_bt <- p_bt + facet_wrap(~ temp, ncol = 2, scales = "free")+ geom_smooth()
ggsave("../results/p_bt1.pdf", plot = p_bt)
p_bt <- ggplot(a2, aes(x = time, y = stdvalue)) + geom_point() + theme_bw() +
labs(title = "Fecundity change with time: 1.Anthonomus grandis",
x = "Time (days)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 10, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 10),
axis.title.y=element_text(size= 10))
p_bt
View(b1)
p_bt <- ggplot(b1, aes(x = time, y = stdvalue)) + geom_point() + theme_bw() +
labs(title = "Fecundity change with time: 1.Anthonomus grandis",
x = "Time (days)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 10, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 10),
axis.title.y=element_text(size= 10))
p_bt
p_bt <- p_bt + facet_wrap(~ temp, ncol = 2, scales = "free")+ geom_smooth()
ggsave("../results/p_bt1.pdf", plot = p_bt)
stdtemp <- paste(b1$temp,"(\u00B0C)",sep = "" )
View(b1)
b1$stdtemp <- paste(b1$temp,"(\u00B0C)",sep = "" )
View(b1)
p_bt <- ggplot(b1, aes(x = time, y = stdvalue)) + geom_point() + theme_bw() +
labs(title = "Fecundity change with time: 1.Anthonomus grandis",
x = "Time (days)",
y = "Fecundity (Eggs/female/day)")+
theme(plot.title = element_text(hjust = 0.5,size = 10, face = "bold.italic"),
axis.text=element_text(size=8,face = "bold"),
axis.title.x=element_text(size= 10),
axis.title.y=element_text(size= 10))
p_bt <- p_bt + facet_wrap(~ stdtemp, ncol = 2, scales = "free")+ geom_smooth()
ggsave("../results/p_bt1.pdf", plot = p_bt)
